<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>Python Environment Setup for Implementation | Herman-blog</title>
    <meta name="author" content="Herman Teng" />
    <meta name="keywords" content="Data, Analysis, JavaScript, Python, SQL, NoSQL, Web, Finance, Banking" />
    <meta name="description" content="Python is a good scripting language to boost your productivity on data analysis and BI reporting. As open source language, you can easily get the binary installation file from python official site for windows and source code on vary versions for Linu" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    
    <link rel="icon" href="/images/favicon1.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
<meta name="generator" content="Hexo 5.2.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Herman-blog</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">Home</span>
            </a>
        
            <a class="nav-item" href="/categories/data">
                <span class="nav-text">Data</span>
            </a>
        
            <a class="nav-item" href="/categories/it">
                <span class="nav-text">IT</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">Tags</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">Archives</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">About</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://hermanteng19.github.io"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-environment-variable-configuration-and-local-folder-set-up-for-your-file-package-and-library"><span class="toc-number">1.</span> <span class="toc-text">Python environment variable configuration and local folder set up for your file, package and library</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-readiness-test-in-localhost-for-SQL-database-connection-Anaconda-virtual-environment"><span class="toc-number">2.</span> <span class="toc-text">Python readiness test in localhost for SQL database connection (Anaconda virtual environment)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-and-SQL-database-connection-facility-with-supported-drivers"><span class="toc-number">2.1.</span> <span class="toc-text">Python and SQL database connection facility with supported drivers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-SQL-Server-database-connection-and-data-task"><span class="toc-number">2.2.</span> <span class="toc-text">Python SQL Server database connection and data task</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-DB2-database-connection-and-data-task"><span class="toc-number">2.3.</span> <span class="toc-text">Python DB2 database connection and data task</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Productionize-Python-script-by-passing-in-parameters"><span class="toc-number">3.</span> <span class="toc-text">Productionize Python script by passing in parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-%E2%80%93-python-interpreter"><span class="toc-number">4.</span> <span class="toc-text">Encapsulate into SSIS to minimize change in production deployment – python interpreter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-%E2%80%93-batch-process"><span class="toc-number">5.</span> <span class="toc-text">Encapsulate into SSIS to minimize change in production deployment – batch process</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Call-user-defined-module-or-function-in-python-script"><span class="toc-number">6.</span> <span class="toc-text">Call user defined module or function in python script</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 1200px">
                <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            Python Environment Setup for Implementation
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://hermanteng19.github.io/2020/12/08/Python-Environment-Setup-for-Implementation/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2020-12-08T19:21:38.000Z" itemprop="datePublished">2020-12-08</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/python-sql-db2-CLI-SSIS-config/" rel="tag">python, sql, db2, CLI, SSIS, config</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>Python is a good scripting language to boost your productivity on data analysis and BI reporting. As open source language, you can easily get the binary installation file from <a target="_blank" rel="noopener" href="https://www.python.org/">python official site</a> for windows and source code on vary versions for Linux, in production, it’s better choose installation approach by source code.</p>
<p>We also need to setup python environment after installation so that we can not only use python interpreter to develop but also make it executable by CLI and even some ETL tool such as Microsoft SSIS.</p>
<h2 id="Python-environment-variable-configuration-and-local-folder-set-up-for-your-file-package-and-library"><a href="#Python-environment-variable-configuration-and-local-folder-set-up-for-your-file-package-and-library" class="headerlink" title="Python environment variable configuration and local folder set up for your file, package and library"></a>Python environment variable configuration and local folder set up for your file, package and library</h2><p>If python is installed in system-wise, then you need to create some new folders to store you python file, package and library, e.g. python install path is “D:\Python36&quot;, then you need to add python executable interpreter to be a part of the PATH variable. Next create python environment variable PYTHONPATH with the following paths and create empty file __init__.py file in each of these folders:</p>
<ul>
<li>create a new folder under D drive “D:\pyLib” and set that directory as value of PYTHONPATH and create __init__.py file in “D:\pyLib”</li>
<li>you can also create subfolder to assign different permissions for different user group<ul>
<li>create a subfolder “D:\pyLib\AD-group1” and create the __init__.py file in it.</li>
<li>create a subfolder “D:\pyLib\AD-group2” and create the __init__.py file in it.</li>
</ul>
</li>
</ul>
<p>For Linux, if you install python3 by source code and directory is <code>/usr/local/python3</code>, then edit <code>~/.bash_profile</code> file, append the python directory into PATH</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3</span></span><br><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/python3/bin/:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<p>then run <code>source ~/.bash_profile</code> let setting take effect</p>
<p>if your system pre-installed python2 then it’s necessary to make a soft link</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /user/<span class="built_in">local</span>/python3/bin/python3 /user/bin/python3</span><br><span class="line">ln -s /user/<span class="built_in">local</span>/python3/bin/pip3 /user/bim/pip3</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>setup name space and package python scripts for development project to be able to importable</p>
<ul>
<li>create or edit environment variable and add your python files folder into your system directory</li>
<li>enter your python file folder to create an empty file __init__.py file</li>
<li>open terminal prompt type python to active python interactive console</li>
<li>import sys</li>
<li>execute sys.path to make sure your python file folder is recognizable by python</li>
</ul>
<p><img src="https://p.130014.xyz/2020/12/10/edit_env_var1.png" alt="edit_env_var1.png"></p>
<p><img src="https://p.130014.xyz/2020/12/10/edit_env_var2.png" alt="edit_env_var2.png"></p>
<h2 id="Python-readiness-test-in-localhost-for-SQL-database-connection-Anaconda-virtual-environment"><a href="#Python-readiness-test-in-localhost-for-SQL-database-connection-Anaconda-virtual-environment" class="headerlink" title="Python readiness test in localhost for SQL database connection (Anaconda virtual environment)"></a>Python readiness test in localhost for SQL database connection (Anaconda virtual environment)</h2><p>First check python and Ipython version by issue command <code>python --version</code> and <code>ipython --version</code>. Anaconda almost pre-installs all python prevailing and popular libraries in its virtual environment, to check library list by using command <code>pip list</code></p>
<h3 id="Python-and-SQL-database-connection-facility-with-supported-drivers"><a href="#Python-and-SQL-database-connection-facility-with-supported-drivers" class="headerlink" title="Python and SQL database connection facility with supported drivers"></a>Python and SQL database connection facility with supported drivers</h3><p>Depends on what python library do you install for database connectivity, it usually comes with function to show you available drivers to connect python to your database, e.g: pyodbc, use <code>drivers()</code> function to list the odbc drivers</p>
<p><img src="https://p.130014.xyz/2020/12/10/odbc_drivers.png" alt="odbc_drivers.png"></p>
<h3 id="Python-SQL-Server-database-connection-and-data-task"><a href="#Python-SQL-Server-database-connection-and-data-task" class="headerlink" title="Python SQL Server database connection and data task"></a>Python SQL Server database connection and data task</h3><p>SQL Server database can be connected both by DB API (pyodbc) and ORM (sqlalchemy), create a py script and run sql query from user input</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"><span class="keyword">import</span> sqlalchemy</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pyquery</span>(<span class="params">conn</span>):</span></span><br><span class="line">    cnxn = pyodbc.connect(conn)</span><br><span class="line">    cur = cnxn.cursor()</span><br><span class="line">    sql_cmd = <span class="built_in">input</span>(<span class="string">&quot;Input your sql command with database name: &quot;</span>)</span><br><span class="line">    result = cur.execute(sql_cmd)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">        print(row)</span><br><span class="line">    cur.close()</span><br><span class="line">    cnxn.close()</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2mssql</span>():</span></span><br><span class="line">    way2conn = <span class="built_in">input</span>(<span class="string">&quot;Do you want to connect to db by [ORM] or [DBAPI]: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> way2conn.upper()==<span class="string">&quot;DPAPI&quot;</span>:</span><br><span class="line">        dsn_str = <span class="built_in">input</span>(<span class="string">&quot;Do you want to connect to db by [connection string] or [DSN]: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> dsn_str.upper()==<span class="string">&quot;DSN&quot;</span>:</span><br><span class="line">            dsn_name=<span class="built_in">input</span>(<span class="string">&quot;Please enter your DSN name: &quot;</span>)</span><br><span class="line">            conn_dsn=<span class="string">&#x27;DSN&#123;&#125;;Trusted_connection=yes&#x27;</span>.<span class="built_in">format</span>(dsn_name)</span><br><span class="line">            conn=conn_dsn</span><br><span class="line">            pyquery(conn)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            conn_str=<span class="string">&#x27;DRIVER=&#123;SQL Server Native Client 11.0&#125;; SERVER=YOURSERVERNAME;DATABASE=YOURDB;Trusted_connection=yes&#x27;</span></span><br><span class="line">            conn=conn_str</span><br><span class="line">            pyquery(conn)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ser_name=<span class="built_in">input</span>(<span class="string">&#x27;Please enter your server name: &#x27;</span>)</span><br><span class="line">        db_name=<span class="built_in">input</span>(<span class="string">&#x27;Please enter your database name: &#x27;</span>)</span><br><span class="line">        tbl_name=<span class="built_in">input</span>(<span class="string">&#x27;Enter the table name: &#x27;</span>)</span><br><span class="line">        orm_dict=&#123;<span class="string">&#x27;servername&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ser_name), <span class="string">&#x27;database&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(db_name), <span class="string">&#x27;driver&#x27;</span>:<span class="string">&#x27;driver=SQL Server Native Client 11.0&#x27;</span>&#125;</span><br><span class="line">        engine=create_engine(<span class="string">&#x27;mssql+pyodbc://&#x27;</span>+orm_dict[<span class="string">&#x27;servername&#x27;</span>]+<span class="string">&#x27;/&#x27;</span>+orm_dict[<span class="string">&#x27;database&#x27;</span>]+<span class="string">&#x27;?&#x27;</span>+orm_dict[<span class="string">&#x27;driver&#x27;</span>])</span><br><span class="line">        df=pd.read_sql_table(tbl_name, engine, index_col=<span class="number">0</span>, schema=<span class="string">&#x27;dbo&#x27;</span>)</span><br><span class="line">        print(df.head(<span class="number">10</span>))</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    py2mssql()</span><br></pre></td></tr></table></figure>

<p>script both can be ran directly or imported (recommend) after setup PYTHONPATH variable in your account and copy that script over to the path of environment variable.</p>
<p><img src="https://p.130014.xyz/2020/12/10/py2mssql.png" alt="py2mssql.png"></p>
<h3 id="Python-DB2-database-connection-and-data-task"><a href="#Python-DB2-database-connection-and-data-task" class="headerlink" title="Python DB2 database connection and data task"></a>Python DB2 database connection and data task</h3><p>We can only connect to DB2 by DBAPI (pyodbc), connection string doesn’t work but only DSN (PRD1 was setup as system DSN in local and server) plus user id and password. Use below script to try to connect</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"><span class="keyword">import</span> getpass</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2edw</span>():</span></span><br><span class="line">    uid=getpass.getuser()</span><br><span class="line">    print(<span class="string">&quot;Your user id is &#x27;&#123;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(uid))</span><br><span class="line">    pwd=getpass.getpass(<span class="string">&quot;Please enter your db2 password: &quot;</span>)</span><br><span class="line">    dsn=<span class="built_in">input</span>(<span class="string">&quot;Please enter your db2 dsn name: &quot;</span>)</span><br><span class="line">    conn_dsn=<span class="string">&#x27;DSN=&#123;0&#125;; UID=&#123;1&#125;; PWD=&#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(dsn, uid, pwd)</span><br><span class="line">    conn=pyodbc.connect(conn_dsn)</span><br><span class="line">    cur=conn.cursor()</span><br><span class="line">    sql_cmd= <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    		select * from table</span></span><br><span class="line"><span class="string">    		&#x27;&#x27;&#x27;</span></span><br><span class="line">    result=cur.execute(sql_cmd)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">        print(row)</span><br><span class="line">    cur.close()</span><br><span class="line">    </span><br><span class="line">    df=pd.read_sql_query(sql_cmd, conn)</span><br><span class="line">    print(df.info())</span><br><span class="line">    print(df)</span><br><span class="line">    conn.close()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    py2edw()</span><br></pre></td></tr></table></figure>

<p>one thing need to be aware is the script better runs on the shell than python interactive console because pyQT doesn’t support password masking</p>
<p><img src="https://p.130014.xyz/2020/12/10/py2db2_m.png" alt="py2db2_m.png"></p>
<h2 id="Productionize-Python-script-by-passing-in-parameters"><a href="#Productionize-Python-script-by-passing-in-parameters" class="headerlink" title="Productionize Python script by passing in parameters"></a>Productionize Python script by passing in parameters</h2><p>In this section we will demonstrate how you can parameterize your code in python or pyspark so that you can use these techniques before deployed your script into production for automation. It’s best practice to parameterize database names, tables names, and dates so that you can pass these values as inputs to your script. This is beneficial when writing code for values that are dynamic in nature, which can change depending on the environment and/or use case.</p>
<p>The key module is from python standard library: <code>sys</code>. Assign variables through <code>sys.argv[...]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2mssql</span>():</span></span><br><span class="line">    ser_name=sys.argv[<span class="number">1</span>] <span class="comment"># sys.argv[0] is assigned to python script itself, all other parameters start from 1</span></span><br><span class="line">    db_name=sys.argv[<span class="number">2</span>]</span><br><span class="line">    tbl_name=sys.argv[<span class="number">3</span>]</span><br><span class="line">    orm_dict=&#123;<span class="string">&#x27;servername&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ser_name),<span class="string">&#x27;database&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(db_name),</span><br><span class="line">             <span class="string">&#x27;driver&#x27;</span>:<span class="string">&#x27;driver=SQL Server Native Client 11.0&#x27;</span>&#125;</span><br><span class="line">    engine=create_engine(<span class="string">&#x27;mssql+pyodbc://&#x27;</span>+orm_dict[<span class="string">&#x27;servername&#x27;</span>]+<span class="string">&#x27;/&#x27;</span>+</span><br><span class="line">                        orm_dict[<span class="string">&#x27;database&#x27;</span>]+<span class="string">&#x27;?&#x27;</span>+orm_dict[<span class="string">&#x27;driver&#x27;</span>])</span><br><span class="line">    df=pd.read_sql_table(tbl_name, engine, index_col=<span class="number">0</span>, schema=<span class="string">&#x27;dbo&#x27;</span>)</span><br><span class="line">    df.to_sql(<span class="string">&#x27;pandas_sql_test&#x27;</span>, engine, schema=<span class="string">&#x27;dbo&#x27;</span>, if_exists=<span class="string">&#x27;replace&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    py2mssql()</span><br></pre></td></tr></table></figure>

<p>run python script in CLI (command line interface) by following parameter values</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipython py2mssql_argvdf.py yourSvrNm yourDBNm yourTblNm</span><br></pre></td></tr></table></figure>

<p><img src="https://p.130014.xyz/2020/12/10/py2sql_argvdf.png" alt="py2sql_argvdf.png"></p>
<h2 id="Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-python-interpreter"><a href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-python-interpreter" class="headerlink" title="Encapsulate into SSIS to minimize change in production deployment – python interpreter"></a>Encapsulate into SSIS to minimize change in production deployment – python interpreter</h2><p>An alternative way to apply python in production is leverage current SSIS package and embed python script in process task</p>
<p><img src="https://p.130014.xyz/2020/12/10/pyssis1.png" alt="pyssis1.png"></p>
<p>you can hard code the configuration or use expression (VB) through variables in package</p>
<p><img src="https://p.130014.xyz/2020/12/10/pyssis2.png" alt="pyssis2.png"></p>
<p><img src="https://p.130014.xyz/2020/12/10/pyssis3.png" alt="pyssis3.png"></p>
<h2 id="Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-batch-process"><a href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-batch-process" class="headerlink" title="Encapsulate into SSIS to minimize change in production deployment – batch process"></a>Encapsulate into SSIS to minimize change in production deployment – batch process</h2><p>use batch process by .bat file also can achieve that task</p>
<p><img src="https://p.130014.xyz/2020/12/10/pyssis4.png" alt="pyssis4.png"></p>
<h2 id="Call-user-defined-module-or-function-in-python-script"><a href="#Call-user-defined-module-or-function-in-python-script" class="headerlink" title="Call user defined module or function in python script"></a>Call user defined module or function in python script</h2><p>It’s very efficient to create bunch of generic module packages to contain functions to be used widely by other python scripts for specific tasks.</p>
<table>
<thead>
<tr>
<th>1.</th>
<th align="left">Firstly, setup python environment variable to include directories which are recognized by python</th>
</tr>
</thead>
<tbody><tr>
<td>2.</td>
<td align="left">Create __init__.py file (can be empty) in these folders</td>
</tr>
<tr>
<td>3.</td>
<td align="left">Create python programs and save script should end up with if __name__==”__main__“: main()</td>
</tr>
<tr>
<td>4.</td>
<td align="left">Ready to import user modules and functions</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> py2mssql_module <span class="keyword">as</span> db</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">tbl_name=sys.argv[<span class="number">1</span>]</span><br><span class="line">df=pd.read_sql_table(tbl_name, db.py2mssql(<span class="string">&#x27;serverName&#x27;</span>,<span class="string">&#x27;databaseName&#x27;</span>), index_col=<span class="number">0</span>, schema=<span class="string">&#x27;dbo&#x27;</span>)</span><br><span class="line">print(df.head(<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
















        
    </section>
</article>



<a id="pagenext" href="/2020/12/07/Generate-non-comma-delimiter-CSV-file/" class="article-next" title="Generate non comma delimiter CSV file"><i class="icon-arrow-right"></i></a>


<a id="pageprev" href="/2020/12/11/Oracle-client-side-configuration-for-12C/" class="article-prev" title="Oracle client side configuration for 12C"><i class="icon-arrow-left"></i></a>




            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
</footer>

    </main>

    <script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle('normal', slideDone);
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp('normal', slideDone);
            }, 3000);
        }

        function slideDone() {
            if (nodes.navInner.css('display') !== 'none') {
                nodes.navInner.css('display', '');
            }
        }

        $(window).on('resize', function() {
            if ($(this).width() > 960) {
                nodes.navInner.css('display', '');
            }
        });
    });
    </script>
    
        
<script src="/js/scrollspy.min.js"></script>

        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});

        $(window).on('resize', function() {
            var hw = $('#header').width();
            var ww = $('#wrapper').width();
            var space = ($(this).width() - hw - ww) / 2 / 2;

            var pageprev = $('#pageprev');
            var pagenext = $('#pagenext');
            var avg = (pageprev.width() + pagenext.width()) / 2

            if(space > avg) {
                var len = space - avg / 2;
                var styles = {position: 'fixed', top: '50%', marginTop: - (pageprev.width() + pagenext.width()) / 4}
                pageprev.css($.extend({left: hw + len}, styles));
                pagenext.css($.extend({right: len}, styles));
            } else {
                pageprev.removeAttr('style');
                pagenext.removeAttr('style');
            }
        }).trigger('resize');
        </script>
    

</body>
</html>
