<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Python Environment Setup for Implementation - Herman-blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Icaurs - Hexo Theme"><meta name="msapplication-TileImage" content="/img/favicon1.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Icaurs - Hexo Theme"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="Python is a good scripting language to boost your productivity on data analysis and BI reporting. As open source language, you can easily get the binary installation file from python official site for"><meta property="og:type" content="blog"><meta property="og:title" content="Python Environment Setup for Implementation"><meta property="og:url" content="https://hermanteng19.github.io/2020/12/08/Python-Environment-Setup-for-Implementation/"><meta property="og:site_name" content="Herman-blog"><meta property="og:description" content="Python is a good scripting language to boost your productivity on data analysis and BI reporting. As open source language, you can easily get the binary installation file from python official site for"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://hermanteng19.github.io/img/pysql.jpeg"><meta property="article:published_time" content="2020-12-08T19:21:38.000Z"><meta property="article:modified_time" content="2021-11-28T03:14:21.045Z"><meta property="article:author" content="Herman Teng"><meta property="article:tag" content="python, sql, db2, CLI, SSIS, config"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/pysql.jpeg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hermanteng19.github.io/2020/12/08/Python-Environment-Setup-for-Implementation/"},"headline":"Herman-blog","image":[],"datePublished":"2020-12-08T19:21:38.000Z","dateModified":"2021-11-28T03:14:21.045Z","author":{"@type":"Person","name":"Herman Teng"},"description":"Python is a good scripting language to boost your productivity on data analysis and BI reporting. As open source language, you can easily get the binary installation file from python official site for"}</script><link rel="canonical" href="https://hermanteng19.github.io/2020/12/08/Python-Environment-Setup-for-Implementation/"><link rel="icon" href="/img/favicon1.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/avatar1.png" alt="Herman-blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/img/pysql.jpeg" alt="Python Environment Setup for Implementation"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-12-08T19:21:38.000Z" title="2020-12-08T19:21:38.000Z">2020-12-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-11-28T03:14:21.045Z" title="2021-11-28T03:14:21.045Z">2021-11-27</time></span><span class="level-item"><a class="link-muted" href="/categories/IT-BI/">IT, BI</a></span><span class="level-item">9 minutes read (About 1405 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Python Environment Setup for Implementation</h1><div class="content"><p>Python is a good scripting language to boost your productivity on data analysis and BI reporting. As open source language, you can easily get the binary installation file from <a target="_blank" rel="noopener" href="https://www.python.org/">python official site</a> for windows and source code on vary versions for Linux, in production, it’s better choose installation approach by source code.</p>
<p>We also need to setup python environment after installation so that we can not only use python interpreter to develop but also make it executable by CLI and even some ETL tool such as Microsoft SSIS.</p>
<h2 id="Python-environment-variable-configuration-and-local-folder-set-up-for-your-file-package-and-library"><a href="#Python-environment-variable-configuration-and-local-folder-set-up-for-your-file-package-and-library" class="headerlink" title="Python environment variable configuration and local folder set up for your file, package and library"></a>Python environment variable configuration and local folder set up for your file, package and library</h2><p>If python is installed in system-wise, then you need to create some new folders to store you python file, package and library, e.g. python install path is “D:\Python36&quot;, then you need to add python executable interpreter to be a part of the PATH variable. Next create python environment variable PYTHONPATH with the following paths and create empty file __init__.py file in each of these folders:</p>
<ul>
<li>create a new folder under D drive “D:\pyLib” and set that directory as value of PYTHONPATH and create __init__.py file in “D:\pyLib”</li>
<li>you can also create subfolder to assign different permissions for different user group<ul>
<li>create a subfolder “D:\pyLib\AD-group1” and create the __init__.py file in it.</li>
<li>create a subfolder “D:\pyLib\AD-group2” and create the __init__.py file in it.</li>
</ul>
</li>
</ul>
<p>For Linux, if you install python3 by source code and directory is <code>/usr/local/python3</code>, then edit <code>~/.bash_profile</code> file, append the python directory into PATH</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3</span></span><br><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/python3/bin/:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<p>then run <code>source ~/.bash_profile</code> let setting take effect</p>
<p>if your system pre-installed python2 then it’s necessary to make a soft link</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /user/<span class="built_in">local</span>/python3/bin/python3 /user/bin/python3</span><br><span class="line">ln -s /user/<span class="built_in">local</span>/python3/bin/pip3 /user/bim/pip3</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>setup name space and package python scripts for development project to be able to importable</p>
<ul>
<li>create or edit environment variable and add your python files folder into your system directory</li>
<li>enter your python file folder to create an empty file __init__.py file</li>
<li>open terminal prompt type python to active python interactive console</li>
<li>import sys</li>
<li>execute sys.path to make sure your python file folder is recognizable by python</li>
</ul>
<p><img src="/img/screenshots/edit_env_var1.png" alt="edit_env_var1.png"></p>
<p><img src="/img/screenshots/edit_env_var2.png" alt="edit_env_var2.png"></p>
<h2 id="Python-readiness-test-in-localhost-for-SQL-database-connection-Anaconda-virtual-environment"><a href="#Python-readiness-test-in-localhost-for-SQL-database-connection-Anaconda-virtual-environment" class="headerlink" title="Python readiness test in localhost for SQL database connection (Anaconda virtual environment)"></a>Python readiness test in localhost for SQL database connection (Anaconda virtual environment)</h2><p>First check python and Ipython version by issue command <code>python --version</code> and <code>ipython --version</code>. Anaconda almost pre-installs all python prevailing and popular libraries in its virtual environment, to check library list by using command <code>pip list</code></p>
<h3 id="Python-and-SQL-database-connection-facility-with-supported-drivers"><a href="#Python-and-SQL-database-connection-facility-with-supported-drivers" class="headerlink" title="Python and SQL database connection facility with supported drivers"></a>Python and SQL database connection facility with supported drivers</h3><p>Depends on what python library do you install for database connectivity, it usually comes with function to show you available drivers to connect python to your database, e.g: pyodbc, use <code>drivers()</code> function to list the odbc drivers</p>
<p><img src="/img/screenshots/odbc_drivers.png" alt="odbc_drivers.png"></p>
<h3 id="Python-SQL-Server-database-connection-and-data-task"><a href="#Python-SQL-Server-database-connection-and-data-task" class="headerlink" title="Python SQL Server database connection and data task"></a>Python SQL Server database connection and data task</h3><p>SQL Server database can be connected both by DB API (pyodbc) and ORM (sqlalchemy), create a py script and run sql query from user input</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"><span class="keyword">import</span> sqlalchemy</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pyquery</span>(<span class="params">conn</span>):</span></span><br><span class="line">    cnxn = pyodbc.connect(conn)</span><br><span class="line">    cur = cnxn.cursor()</span><br><span class="line">    sql_cmd = <span class="built_in">input</span>(<span class="string">&quot;Input your sql command with database name: &quot;</span>)</span><br><span class="line">    result = cur.execute(sql_cmd)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">        print(row)</span><br><span class="line">    cur.close()</span><br><span class="line">    cnxn.close()</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2mssql</span>():</span></span><br><span class="line">    way2conn = <span class="built_in">input</span>(<span class="string">&quot;Do you want to connect to db by [ORM] or [DBAPI]: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> way2conn.upper()==<span class="string">&quot;DPAPI&quot;</span>:</span><br><span class="line">        dsn_str = <span class="built_in">input</span>(<span class="string">&quot;Do you want to connect to db by [connection string] or [DSN]: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> dsn_str.upper()==<span class="string">&quot;DSN&quot;</span>:</span><br><span class="line">            dsn_name=<span class="built_in">input</span>(<span class="string">&quot;Please enter your DSN name: &quot;</span>)</span><br><span class="line">            conn_dsn=<span class="string">&#x27;DSN&#123;&#125;;Trusted_connection=yes&#x27;</span>.<span class="built_in">format</span>(dsn_name)</span><br><span class="line">            conn=conn_dsn</span><br><span class="line">            pyquery(conn)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            conn_str=<span class="string">&#x27;DRIVER=&#123;SQL Server Native Client 11.0&#125;; SERVER=YOURSERVERNAME;DATABASE=YOURDB;Trusted_connection=yes&#x27;</span></span><br><span class="line">            conn=conn_str</span><br><span class="line">            pyquery(conn)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ser_name=<span class="built_in">input</span>(<span class="string">&#x27;Please enter your server name: &#x27;</span>)</span><br><span class="line">        db_name=<span class="built_in">input</span>(<span class="string">&#x27;Please enter your database name: &#x27;</span>)</span><br><span class="line">        tbl_name=<span class="built_in">input</span>(<span class="string">&#x27;Enter the table name: &#x27;</span>)</span><br><span class="line">        orm_dict=&#123;<span class="string">&#x27;servername&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ser_name), <span class="string">&#x27;database&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(db_name), <span class="string">&#x27;driver&#x27;</span>:<span class="string">&#x27;driver=SQL Server Native Client 11.0&#x27;</span>&#125;</span><br><span class="line">        engine=create_engine(<span class="string">&#x27;mssql+pyodbc://&#x27;</span>+orm_dict[<span class="string">&#x27;servername&#x27;</span>]+<span class="string">&#x27;/&#x27;</span>+orm_dict[<span class="string">&#x27;database&#x27;</span>]+<span class="string">&#x27;?&#x27;</span>+orm_dict[<span class="string">&#x27;driver&#x27;</span>])</span><br><span class="line">        df=pd.read_sql_table(tbl_name, engine, index_col=<span class="number">0</span>, schema=<span class="string">&#x27;dbo&#x27;</span>)</span><br><span class="line">        print(df.head(<span class="number">10</span>))</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    py2mssql()</span><br></pre></td></tr></table></figure>

<p>script both can be ran directly or imported (recommend) after setup PYTHONPATH variable in your account and copy that script over to the path of environment variable.</p>
<p><img src="/img/screenshots/py2mssql.png" alt="py2mssql.png"></p>
<h3 id="Python-DB2-database-connection-and-data-task"><a href="#Python-DB2-database-connection-and-data-task" class="headerlink" title="Python DB2 database connection and data task"></a>Python DB2 database connection and data task</h3><p>We can only connect to DB2 by DBAPI (pyodbc), connection string doesn’t work but only DSN (PRD1 was setup as system DSN in local and server) plus user id and password. Use below script to try to connect</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"><span class="keyword">import</span> getpass</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2edw</span>():</span></span><br><span class="line">    uid=getpass.getuser()</span><br><span class="line">    print(<span class="string">&quot;Your user id is &#x27;&#123;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(uid))</span><br><span class="line">    pwd=getpass.getpass(<span class="string">&quot;Please enter your db2 password: &quot;</span>)</span><br><span class="line">    dsn=<span class="built_in">input</span>(<span class="string">&quot;Please enter your db2 dsn name: &quot;</span>)</span><br><span class="line">    conn_dsn=<span class="string">&#x27;DSN=&#123;0&#125;; UID=&#123;1&#125;; PWD=&#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(dsn, uid, pwd)</span><br><span class="line">    conn=pyodbc.connect(conn_dsn)</span><br><span class="line">    cur=conn.cursor()</span><br><span class="line">    sql_cmd= <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    		select * from table</span></span><br><span class="line"><span class="string">    		&#x27;&#x27;&#x27;</span></span><br><span class="line">    result=cur.execute(sql_cmd)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">        print(row)</span><br><span class="line">    cur.close()</span><br><span class="line">    </span><br><span class="line">    df=pd.read_sql_query(sql_cmd, conn)</span><br><span class="line">    print(df.info())</span><br><span class="line">    print(df)</span><br><span class="line">    conn.close()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    py2edw()</span><br></pre></td></tr></table></figure>

<p>one thing need to be aware is the script better runs on the shell than python interactive console because pyQT doesn’t support password masking</p>
<p><img src="/img/screenshots/py2db2_m.png" alt="py2db2_m.png"></p>
<h2 id="Productionize-Python-script-by-passing-in-parameters"><a href="#Productionize-Python-script-by-passing-in-parameters" class="headerlink" title="Productionize Python script by passing in parameters"></a>Productionize Python script by passing in parameters</h2><p>In this section we will demonstrate how you can parameterize your code in python or pyspark so that you can use these techniques before deployed your script into production for automation. It’s best practice to parameterize database names, tables names, and dates so that you can pass these values as inputs to your script. This is beneficial when writing code for values that are dynamic in nature, which can change depending on the environment and/or use case.</p>
<p>The key module is from python standard library: <code>sys</code>. Assign variables through <code>sys.argv[...]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2mssql</span>():</span></span><br><span class="line">    ser_name=sys.argv[<span class="number">1</span>] <span class="comment"># sys.argv[0] is assigned to python script itself, all other parameters start from 1</span></span><br><span class="line">    db_name=sys.argv[<span class="number">2</span>]</span><br><span class="line">    tbl_name=sys.argv[<span class="number">3</span>]</span><br><span class="line">    orm_dict=&#123;<span class="string">&#x27;servername&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ser_name),<span class="string">&#x27;database&#x27;</span>:<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(db_name),</span><br><span class="line">             <span class="string">&#x27;driver&#x27;</span>:<span class="string">&#x27;driver=SQL Server Native Client 11.0&#x27;</span>&#125;</span><br><span class="line">    engine=create_engine(<span class="string">&#x27;mssql+pyodbc://&#x27;</span>+orm_dict[<span class="string">&#x27;servername&#x27;</span>]+<span class="string">&#x27;/&#x27;</span>+</span><br><span class="line">                        orm_dict[<span class="string">&#x27;database&#x27;</span>]+<span class="string">&#x27;?&#x27;</span>+orm_dict[<span class="string">&#x27;driver&#x27;</span>])</span><br><span class="line">    df=pd.read_sql_table(tbl_name, engine, index_col=<span class="number">0</span>, schema=<span class="string">&#x27;dbo&#x27;</span>)</span><br><span class="line">    df.to_sql(<span class="string">&#x27;pandas_sql_test&#x27;</span>, engine, schema=<span class="string">&#x27;dbo&#x27;</span>, if_exists=<span class="string">&#x27;replace&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    py2mssql()</span><br></pre></td></tr></table></figure>

<p>run python script in CLI (command line interface) by following parameter values</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipython py2mssql_argvdf.py yourSvrNm yourDBNm yourTblNm</span><br></pre></td></tr></table></figure>

<p><img src="/img/screenshots/py2sql_argvdf.png" alt="py2sql_argvdf.png"></p>
<h2 id="Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-python-interpreter"><a href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-python-interpreter" class="headerlink" title="Encapsulate into SSIS to minimize change in production deployment – python interpreter"></a>Encapsulate into SSIS to minimize change in production deployment – python interpreter</h2><p>An alternative way to apply python in production is leverage current SSIS package and embed python script in process task</p>
<p><img src="/img/screenshots/pyssis1.png" alt="pyssis1.png"></p>
<p>you can hard code the configuration or use expression (VB) through variables in package</p>
<p><img src="/img/screenshots/pyssis2.png" alt="pyssis2.png"></p>
<p><img src="/img/screenshots/pyssis3.png" alt="pyssis3.png"></p>
<h2 id="Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-batch-process"><a href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-batch-process" class="headerlink" title="Encapsulate into SSIS to minimize change in production deployment – batch process"></a>Encapsulate into SSIS to minimize change in production deployment – batch process</h2><p>use batch process by .bat file also can achieve that task</p>
<p><img src="/img/screenshots/pyssis4.png" alt="pyssis4.png"></p>
<h2 id="Call-user-defined-module-or-function-in-python-script"><a href="#Call-user-defined-module-or-function-in-python-script" class="headerlink" title="Call user defined module or function in python script"></a>Call user defined module or function in python script</h2><p>It’s very efficient to create bunch of generic module packages to contain functions to be used widely by other python scripts for specific tasks.</p>
<table>
<thead>
<tr>
<th>1.</th>
<th align="left">Firstly, setup python environment variable to include directories which are recognized by python</th>
</tr>
</thead>
<tbody><tr>
<td>2.</td>
<td align="left">Create __init__.py file (can be empty) in these folders</td>
</tr>
<tr>
<td>3.</td>
<td align="left">Create python programs and save script should end up with if __name__==”__main__“: main()</td>
</tr>
<tr>
<td>4.</td>
<td align="left">Ready to import user modules and functions</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> py2mssql_module <span class="keyword">as</span> db</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">tbl_name=sys.argv[<span class="number">1</span>]</span><br><span class="line">df=pd.read_sql_table(tbl_name, db.py2mssql(<span class="string">&#x27;serverName&#x27;</span>,<span class="string">&#x27;databaseName&#x27;</span>), index_col=<span class="number">0</span>, schema=<span class="string">&#x27;dbo&#x27;</span>)</span><br><span class="line">print(df.head(<span class="number">10</span>))</span><br></pre></td></tr></table></figure>















</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/python-sql-db2-CLI-SSIS-config/">python, sql, db2, CLI, SSIS, config</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/12/11/Oracle-client-side-configuration-for-12C/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Oracle client side configuration for 12C</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/12/07/Generate-non-comma-delimiter-CSV-file/"><span class="level-item">Generate non comma delimiter CSV file</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://hermanteng19.github.io/2020/12/08/Python-Environment-Setup-for-Implementation/';
            this.page.identifier = '2020/12/08/Python-Environment-Setup-for-Implementation/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'herman-hexo-blog' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar1.png" alt="Herman"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Herman</p><p class="is-size-6 is-block">Data Analyst&amp;Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Toronto, Canada</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">20</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">18</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/HermanTeng19" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/HermanTeng19"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Python-environment-variable-configuration-and-local-folder-set-up-for-your-file-package-and-library"><span class="level-left"><span class="level-item">1</span><span class="level-item">Python environment variable configuration and local folder set up for your file, package and library</span></span></a></li><li><a class="level is-mobile" href="#Python-readiness-test-in-localhost-for-SQL-database-connection-Anaconda-virtual-environment"><span class="level-left"><span class="level-item">2</span><span class="level-item">Python readiness test in localhost for SQL database connection (Anaconda virtual environment)</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Python-and-SQL-database-connection-facility-with-supported-drivers"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Python and SQL database connection facility with supported drivers</span></span></a></li><li><a class="level is-mobile" href="#Python-SQL-Server-database-connection-and-data-task"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Python SQL Server database connection and data task</span></span></a></li><li><a class="level is-mobile" href="#Python-DB2-database-connection-and-data-task"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Python DB2 database connection and data task</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Productionize-Python-script-by-passing-in-parameters"><span class="level-left"><span class="level-item">3</span><span class="level-item">Productionize Python script by passing in parameters</span></span></a></li><li><a class="level is-mobile" href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-python-interpreter"><span class="level-left"><span class="level-item">4</span><span class="level-item">Encapsulate into SSIS to minimize change in production deployment – python interpreter</span></span></a></li><li><a class="level is-mobile" href="#Encapsulate-into-SSIS-to-minimize-change-in-production-deployment-–-batch-process"><span class="level-left"><span class="level-item">5</span><span class="level-item">Encapsulate into SSIS to minimize change in production deployment – batch process</span></span></a></li><li><a class="level is-mobile" href="#Call-user-defined-module-or-function-in-python-script"><span class="level-left"><span class="level-item">6</span><span class="level-item">Call user defined module or function in python script</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/avatar1.png" alt="Herman-blog" height="28"></a><p class="is-size-7"><span>&copy; 2022 Herman Teng</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>